<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DocRouter Architecture</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="../css/styles.css" rel="stylesheet">
    <!-- Add Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-tomorrow.min.css">
    <script src="../js/load-nav.js"></script>
</head>
<body class="bg-gray-50">
    <div id="nav-container" class="sticky top-0 z-50"></div>

    <div class="max-w-6xl mx-auto px-4 sm:px-6 md:px-8 py-4 md:py-12">
        <header class="text-center md:mb-12 mb-4">
            <h1 class="text-4xl font-bold text-gray-900 mb-4 hidden sm:block">DocRouter Architecture</h1>
            <div class="text-xl text-gray-600">
                <p class="mb-2">System architecture and implementation details for docrouter.ai</p>
            </div>
        </header>

        <main>
            <section id="overview" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">System Overview</h2>
                <p class="text-gray-600 mb-6">
                    DocRouter is a document processing and analysis platform that enables users to extract structured data from documents using OCR and LLM technologies. The system consists of a Next.js frontend, a FastAPI backend, and a MongoDB database.
                </p>
                <div class="architecture-diagram py-4">
                    <pre><code class="language-text">┌────────────────┐      ┌─────────────────┐      ┌─────────────────┐
│                │      │                 │      │                 │
│   Frontend     │◄────►│    Backend      │◄────►│    Database     │
│   (Next.js)    │      │   (FastAPI)     │      │   (MongoDB)     │
│                │      │                 │      │                 │
└────────────────┘      └─────────────────┘      └─────────────────┘
        ▲                       ▲                        
        │                       │                        
        ▼                       ▼                        
┌────────────────┐      ┌─────────────────┐             
│                │      │                 │             
│  Client/User   │      │ External APIs   │             
│  (Browser)     │      │ (OCR, LLM)      │             
│                │      │                 │             
└────────────────┘      └─────────────────┘</code></pre>
                </div>
            </section>

            <section id="components" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Architecture Components</h2>
                
                <h3 class="text-xl font-semibold text-gray-900 mb-4">Frontend Architecture (Next.js)</h3>
                <p class="text-gray-600 mb-4">
                    The frontend utilizes Next.js 14 with the App Router architecture. It follows a component-based approach with the following structure:
                </p>
                <pre><code class="language-bash">frontend/
├── src/
│   ├── app/                    # App Router pages and layouts
│   │   ├── api/                # API routes
│   │   ├── auth/               # Authentication pages
│   │   ├── dashboard/          # Dashboard views
│   │   ├── orgs/               # Organization management
│   │   └── ...                 # Other routes
│   ├── components/             # Reusable React components
│   ├── contexts/               # React context providers
│   ├── hooks/                  # Custom React hooks
│   ├── styles/                 # Global styles
│   ├── types/                  # TypeScript type definitions
│   ├── utils/                  # Utility functions
│   └── auth.ts                 # Authentication configuration
└── public/                     # Static assets</code></pre>
                
                <h4 class="text-lg font-medium text-gray-900 mt-6 mb-3">Key Frontend Technologies</h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div class="border rounded-lg p-4 shadow-sm">
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Next.js 14 with App Router</li>
                            <li>Next-Auth v4 for authentication</li>
                            <li>Tailwind CSS for styling</li>
                            <li>Material UI for complex components and icons</li>
                        </ul>
                    </div>
                    <div class="border rounded-lg p-4 shadow-sm">
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>React-Data-Grid for data tables</li>
                            <li>PDF.js for PDF handling</li>
                            <li>ReactFlow for drag & drop interfaces</li>
                            <li>Axios for API communication</li>
                        </ul>
                    </div>
                </div>
                
                <h3 class="text-xl font-semibold text-gray-900 mb-4 mt-8">Backend Architecture (FastAPI)</h3>
                <p class="text-gray-600 mb-4">
                    The backend is built with FastAPI and provides RESTful API endpoints for various functionalities:
                </p>
                <pre><code class="language-bash">backend/
├── api/
│   ├── __init__.py
│   ├── main.py                # Main FastAPI application
│   ├── schemas.py             # Pydantic schemas/models
│   ├── payments.py            # Payment processing
│   ├── startup.py             # Startup configuration
│   ├── email_utils.py         # Email utilities
│   ├── organizations.py       # Organization management 
│   ├── limits.py              # Rate limiting
│   └── users.py               # User management
├── tests/                     # Test suite
├── worker/                    # Background task processing
└── analytiq_data/             # Data processing library</code></pre>
                
                <h4 class="text-lg font-medium text-gray-900 mt-6 mb-3">Key Backend Technologies</h4>
                <ul class="list-disc list-inside text-gray-600 space-y-1 mb-6">
                    <li>FastAPI for API development</li>
                    <li>Motor for asynchronous MongoDB access</li>
                    <li>JWT for authentication</li>
                    <li>OCR and LLM services integration</li>
                </ul>
                
                <h3 class="text-xl font-semibold text-gray-900 mb-4 mt-8">Database (MongoDB)</h3>
                <p class="text-gray-600 mb-4">
                    The system uses MongoDB for data storage with the following main collections:
                </p>
                <ul class="list-disc list-inside text-gray-600 space-y-1 mb-6">
                    <li>Users</li>
                    <li>Organizations</li>
                    <li>Documents</li>
                    <li>Schemas</li>
                    <li>Prompts</li>
                    <li>Tags</li>
                    <li>LLM Results</li>
                </ul>
            </section>

            <section id="features" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Core Features</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="border rounded-lg p-6 shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-900 mb-3">Authentication & Authorization</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>JWT-based authentication</li>
                            <li>NextAuth.js integration with social logins</li>
                            <li>Role-based access control</li>
                            <li>Organization-level permissions</li>
                            <li>API token management for programmatic access</li>
                        </ul>
                    </div>
                    
                    <div class="border rounded-lg p-6 shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-900 mb-3">Document Management</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Document upload and storage</li>
                            <li>Tagging system for categorization</li>
                            <li>OCR processing for text extraction</li>
                            <li>Metadata extraction and storage</li>
                            <li>Document versioning</li>
                        </ul>
                    </div>
                    
                    <div class="border rounded-lg p-6 shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-900 mb-3">LLM Integration</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>Integration with various LLM models</li>
                            <li>Customizable prompts for document analysis</li>
                            <li>Schema definition for structured data extraction</li>
                            <li>Result verification and management</li>
                            <li>Model selection for different document types</li>
                        </ul>
                    </div>
                    
                    <div class="border rounded-lg p-6 shadow-sm">
                        <h3 class="text-xl font-semibold text-gray-900 mb-3">API and SDK</h3>
                        <ul class="list-disc list-inside text-gray-600 space-y-1">
                            <li>RESTful API endpoints for all operations</li>
                            <li>Python SDK for programmatic access</li>
                            <li>Versioned API endpoints</li>
                            <li>Comprehensive documentation</li>
                            <li>API token authentication</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="data-flow" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Data Flow</h2>
                
                <h3 class="text-lg font-medium text-gray-900 mt-6 mb-3">Authentication Flow</h3>
                <div class="py-4">
                    <pre><code class="language-text">┌────────────┐    ┌────────────┐    ┌────────────┐    ┌────────────┐
│            │    │            │    │            │    │            │
│   Login    │───►│  NextAuth  │───►│  JWT Token │───►│  Access    │
│   Request  │    │            │    │ Generation │    │  Granted   │
│            │    │            │    │            │    │            │
└────────────┘    └────────────┘    └────────────┘    └────────────┘</code></pre>
                </div>
                
                <h3 class="text-lg font-medium text-gray-900 mb-3">Document Processing Flow</h3>
                <div class="py-4">
                    <pre><code class="language-text">┌────────────┐    ┌────────────┐    ┌────────────┐    ┌────────────┐
│            │    │            │    │            │    │            │
│  Document  │───►│    OCR     │───►│    LLM     │───►│ Structured │
│  Upload    │    │ Processing │    │  Analysis  │    │    Data    │
│            │    │            │    │            │    │            │
└────────────┘    └────────────┘    └────────────┘    └────────────┘</code></pre>
                </div>
                
                
            </section>

            <section id="security" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Security Considerations</h2>
                <ul class="list-disc list-inside text-gray-600 space-y-2 mb-6">
                    <li><strong>JWT-based Authentication:</strong> Secure token handling with appropriate expiration</li>
                    <li><strong>HTTPS:</strong> All communications are encrypted using HTTPS</li>
                    <li><strong>Password Hashing:</strong> User passwords are hashed using bcrypt</li>
                    <li><strong>Email Verification:</strong> New accounts require email verification</li>
                    <li><strong>API Rate Limiting:</strong> Prevention of abuse through rate limiting</li>
                    <li><strong>Input Validation:</strong> Comprehensive validation using Pydantic models</li>
                    <li><strong>Role-based Access Control:</strong> Fine-grained permissions based on user roles</li>
                    <li><strong>Organization Isolation:</strong> Data is isolated between organizations</li>
                </ul>
            </section>

            <section id="deployment" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Deployment Architecture</h2>
                <div class="py-4">
                    <pre><code class="language-text">┌─────────────────────────────────────────────────────┐
│                   Cloud Provider                    │
│                                                     │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────┐  │
│  │             │    │             │    │         │  │
│  │  Frontend   │    │  Backend    │    │  MongoDB│  │
│  │  Container  │    │  Container  │    │  Service│  │
│  │             │    │             │    │         │  │
│  └─────────────┘    └─────────────┘    └─────────┘  │
│                                                     │
└─────────────────────────────────────────────────────┘</code></pre>
                </div>
                
                <h3 class="text-lg font-medium text-gray-900 mt-6 mb-3">Scalability Considerations</h3>
                <ul class="list-disc list-inside text-gray-600 space-y-2 mb-6">
                    <li>Containerized deployment for easy scaling</li>
                    <li>Stateless API design</li>
                    <li>Asynchronous processing for document analysis</li>
                    <li>Background task workers for long-running processes</li>
                    <li>MongoDB sharding for database scaling</li>
                </ul>
            </section>

            <section id="mcp-integration" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Model Context Protocol Integration</h2>
                <p class="text-gray-600 mb-6">
                    The DocRouter MCP Server is an implementation of Anthropic's Model Context Protocol (MCP) for docrouter.ai. 
                    It enables Claude and other MCP clients to securely access and interact with docrouter.ai workspaces, 
                    providing standardized interfaces for documents, prompts, extraction schemas, and extraction results.
                </p>
                <p class="text-gray-600 mb-6">
                    MCP is an open protocol that standardizes how applications provide context to LLMs. Think of MCP like a USB-C port for AI applications. 
                    Just as USB-C provides a standardized way to connect your devices to various peripherals and accessories, 
                    MCP provides a standardized way to connect AI models to different data sources and tools.
                </p>
                
                <div class="features-grid mt-6">
                    <div class="feature-card">
                        <h3>Authentication</h3>
                        <p class="text-gray-600">Uses docrouter.ai's existing user token-based authentication system to ensure secure access</p>
                    </div>
                    <div class="feature-card">
                        <h3>Document Access</h3>
                        <p class="text-gray-600">Allows LLMs to access document content and metadata through standardized interfaces</p>
                    </div>
                    <div class="feature-card">
                        <h3>Extraction Interface</h3>
                        <p class="text-gray-600">Enables LLMs to run and analyze document extractions with organization's prompts and schemas</p>
                    </div>
                </div>
            </section>

            <section id="roadmap" class="bg-white rounded-lg shadow-lg p-8 mb-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-4">Future Development Roadmap</h2>
                <ul class="list-disc list-inside text-gray-600 space-y-2 mb-6">
                    <li><strong>Enhanced LLM Integration:</strong> Support for more models and advanced prompting techniques</li>
                    <li><strong>Workflow Automation:</strong> Document processing pipelines with conditional branching</li>
                    <li><strong>Advanced Classification:</strong> Improved document categorization using ML</li>
                    <li><strong>Enterprise Integration:</strong> Connectors for common document management systems</li>
                    <li><strong>Mobile Applications:</strong> Native mobile apps for document capture and review</li>
                    <li><strong>Advanced Analytics:</strong> Deeper insights into document processing statistics</li>
                    <li><strong>Collaboration Features:</strong> Enhanced team collaboration tools</li>
                    <li><strong>Multi-language Support:</strong> Expanded OCR and processing for more languages</li>
                </ul>
            </section>

            <section id="github" class="bg-gradient-to-r from-blue-600 to-blue-800 rounded-lg shadow-lg p-8 mb-12">
                <div class="text-center">
                    <h2 class="text-2xl font-semibold text-white mb-4">GitHub Repository</h2>
                    <p class="text-blue-100 mb-6">
                        DocRouter is an open source project.
                        You can find the source code on GitHub.
                    </p>
                    <a href="https://github.com/analytiq-hub/doc-router" 
                       target="_blank"
                       rel="noopener noreferrer"
                       class="inline-block bg-white text-blue-600 hover:bg-blue-50 px-8 py-3 rounded-lg font-medium transition-colors duration-200">
                        View on GitHub
                    </a>
                </div>
            </section>
        </main>

        <footer class="mt-12 text-center text-gray-600">
            <p>© 2025 DocRouter. Part of the <a href="https://github.com/analytiq-hub/doc-router" class="text-blue-600 hover:text-blue-800">docrouter.ai</a> project.</p>
        </footer>
    </div>

    <!-- Prism.js for code highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <script>
        // Call with "../" since we're in a subdirectory
        loadNavigation("../");
    </script>
    <script src="js/dropdown.js"></script>
</body>
</html>
